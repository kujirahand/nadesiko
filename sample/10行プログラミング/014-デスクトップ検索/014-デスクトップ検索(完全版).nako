#-----------------------------------------------------------------------
# 【なでしこで検索】
#-----------------------------------------------------------------------
# 2005/04/12 ... クジラ飛行机 (http://nadesi.com)
#-----------------------------------------------------------------------
# --- 変数の初期化
#-----------------------------------------------------------------------
検索結果は「」

#-----------------------------------------------------------------------
# --- 検索条件を尋ねる
#-----------------------------------------------------------------------
「検索種別=?(ファイル名のみ|ファイル内容)ファイル内容
対象フォルダ=?d
検索語句=
ファイル種類=?(*.txt|*.htm;*.html|*.xml)*.txt
検索方法=?(単純|ワイルドカード|正規表現)単純
検索範囲=?(フォルダ内のみ|フォルダ以下全部)フォルダ以下全部」と項目記入。
もし、それが空ならば、終わり。

検索種別はそれ＠「検索種別」
対象フォルダはそれ＠「対象フォルダ」
検索語句はそれ＠「検索語句」
検索種類はそれ＠「ファイル種類」
検索方法はそれ＠「検索方法」
検索範囲はそれ＠「検索範囲」

#-----------------------------------------------------------------------
# --- 検索
#-----------------------------------------------------------------------
もし、対象フォルダが空ならば、対象フォルダは作業フォルダ。
もし、検索範囲＝「フォルダ内のみ」ならば
　　対象フォルダを検索処理。
違えば
　　対象フォルダを再帰的検索処理。

#-----------------------------------------------------------------------
# --- 結果を画面に表示
#-----------------------------------------------------------------------
結果リストとはリスト。
そのレイアウトは「全体」
そのアイテムは、検索結果。

選択ポップアップとはポップアップメニュー。
これに「
,m1,メモ帳で開く,,,メモ帳開く処理
,m2,直接起動,,,直接起動処理」をポップアップメニュー一括作成。
結果リストのポップアップメニューは選択ポップアップ。

結果リストをダブルクリックした時は〜メモ帳開く処理

#-----------------------------------------------------------------------
# --- 各種処理を定義したもの
#-----------------------------------------------------------------------
●メモ帳開く処理
　　「"notepad.exe" "{結果リストのテキスト}" 」を起動。

●直接起動処理
　　結果リストのテキストを起動。

●検索処理（対象フォルダを）
　　母艦は「検索中：｛対象フォルダ｝」
    対象フォルダ＆検索種類のファイル列挙。
    反復
    　　対象フォルダ＆対象を検索判断処理。

●再帰的検索処理（対象フォルダを）
　　対象フォルダを検索処理。
    # --- 再帰的に検索
    対象フォルダのフォルダ列挙して反復
    　　「{対象フォルダ}{対象}\」を再帰的検索処理。

●検索判断処理（ファイル名を）
　　もし、検索種別が「ファイル名のみ」ならば
    　　内容はファイル名からファイル名抽出したもの
    違えば
    　　内容にファイル名を読む
        拡張子は、ファイル名から拡張子抽出したもの
        拡張子は、拡張子を小文字変換したもの
        # 文字コードを変換する？
        もし、((拡張子&";")で「.xml;.txt;.html;*.htm;」が何文字目)>0ならば
        　　内容＝内容をSJIS変換
　　ここまで
    マッチフラグ＝いいえ
    検索方法で条件分岐
    　　「単純」ならば
        　　内容で検索語句が何文字目。
            もし、それ＞０ならば、マッチフラグ＝はい
        「ワイルドカード」ならば
        　　マッチフラグ＝内容を検索語句でワイルドカードマッチ。
　　　　「正規表現」ならば
        　　内容を検索語句で正規表現マッチ。
            もし、それが空でなければ、マッチフラグ＝はい
    ここまで
　　もし、マッチフラグ＝はいならば
    　　検索結果にファイル名を配列追加。

