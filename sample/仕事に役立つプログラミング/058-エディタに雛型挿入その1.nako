#-----------------------------------------------------------------------
# お気に入りのテキストエディターに機能を追加しよう　その１（第58回）
# http://pc.nikkeibp.co.jp/article/NPC/20080107/290503/?P=2
# (概要)
# 
#-----------------------------------------------------------------------
#-----------------------------------------------------------
# ホットキーファイル挿入
#-----------------------------------------------------------
# 設定
指定キー＝「Ctrl+Shift+A」
対象フォルダ＝マイドキュメント
パターン＝「*.txt」
#-----------------------------------------------------------
母艦のタイトル＝「{指定キー}:ファイル挿入」
指定キーに「挿入処理」をホットキー登録。
母艦を最小化。
イベントフラグ＝オフ。
対象フォルダに作業フォルダ変更
#-----------------------------------------------------------
●挿入処理
　　送信先ハンドル=窓アクティブハンドル取得。
　　もし、送信先ハンドルが０ならば、戻る。
　　# 二重イベント起動防止
　　もし、イベントフラグ＝オンならば、戻る。
　　イベントフラグ＝オン。
　　# 選択ダイアログの表示
　　母艦を元通りに。
　　0.3秒待つ。
　　母艦を最前面。
　　0.3秒待つ。
　　母艦ハンドルを窓アクティブ
　　パターンのファイル選択。
　　対象ファイルはそれ。
　　もし、それが空ならば
　　　　イベントフラグ＝オフ。
　　　　母艦を最小化。
　　　　戻る。
　　内容に対象ファイルを読む。
　　＃キー送信で挿入する
　　退避用はクリップボード。
　　クリップボードは内容。
　　送信先ハンドルに『^v』を窓ハンドルキー送信。
　　0.1秒待つ
　　BEEP
　　クリップボードは退避用。
　　イベントフラグ＝オフ。
　　母艦を最小化。
#-----------------------------------------------------------

