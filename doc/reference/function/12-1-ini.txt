★INIファイルの読み書き

♪概要
INIファイルとはWINDOWS 95/98/MEのころ、WINDOWSの設定や
データを保存しておくのに利用したファイル形式です。
現在ではWINDWOSの設定はレジストリに保存されていますが、
オンラインソフトなど小規模なソフトでは今でも、INIファイルへ
データが保存されることが多いようです。

■INIファイル読み書きの基本

INIファイルは以下の手順で操作します。

・（１）「INI開く」命令でINIファイルを開いてハンドルを得る
・（２）ハンドルを用いて読み書きする
・（３）「INI閉じる」命令でINIファイルのハンドルを閉じる

以下は、デスクトップにINIファイルを作って、
テストというデータを保存しています。

♪ソース〜＠＠
「{デスクトップ}test.ini」のINI開いてHに代入。
Hで「セッション」の「キー1」に「テスト1」をINI書く
Hで「セッション」の「キー2」に「テスト2」をINI書く
HのINI閉じる
＠＠

これを実行するとINIファイルには以下のようにデータが書き込まれます。

♪ソース〜＠＠
[セッション]
キー1=テスト1
キー2=テスト2
＠＠

つまり、INIファイルは、大きくセッションに分かれていて
セッションの中にキーがあり、そのキーに値を読み書きできるように
なっているのです。

♪ソース〜＠＠
[セッション1]
キー1=xxx
キー2=xxx

[セッション2]
キー1=xxx
キー2=xxx

[セッション3]
キー1=xxx
キー2=xxx
...
＠＠

■読み書き例

以下は前半でINIファイルへデータを書き込んで、
後半でそのデータを読み込む例です。

♪ソース〜＠＠
# INIファイル保存例
「{デスクトップ}test.ini」のINI開いてHに代入。
Hで「子供」の「名前」に「太郎」をINI書く
Hで「子供」の「趣味」に「読書」をINI書く
HのINI閉じる

# INIファイル読み込み例
「{デスクトップ}test.ini」のINI開いてHに代入。
Hで「子供」の「名前」をINI読んで表示。
Hで「子供」の「趣味」をINI読んで表示。
HのINI閉じる
＠＠

画面に「太郎」と「読書」と表示されるはずです。
