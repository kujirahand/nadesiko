★モーダルダイアログ

♪概要
　モーダルダイアログはファイルの選択ダイアログや
色の選択ダイアログを出し、ユーザーに質問します。

■モーダルダイアログ

モーダルダイアログは、ユーザーの選択が終わりダイアログが終わるまで
別のフォームの操作ができないようになります。

そのため、プログラムは、上から下へと流れるように記述できるように
なるので便利です。

●文字列を入力するダイアログ

『尋ねる』命令、『メモ記入』命令を使うとユーザーから値を
入力することができます。

以下のプログラムは、ユーザーから値を入力し、それを画面に表示する
プログラムです。

♪ソース〜＠＠
「名前は？」と尋ねる。
それを表示。
＠＠

『メモ記入』命令も『尋ねる』命令と同様に使えますが、『メモ記入』の方は、
メモ帳のようなエディタ画面を出して値を入力できます。


●選択ダイアログ

『リスト選択』命令を使えばリストから１つの項目を選びます。

♪ソース〜＠＠
「ニンジン
レンコン
サンショウ」でリスト選択して表示
＠＠


また、『ボタン選択』命令(vnako専用)と使うと
ボタンに選択肢を表示して選んでもらえます。

♪ソース〜＠＠
「どれにしますか？」を「カレー
パスタ
ハンバーグ」でボタン選択して表示
＠＠


●項目記入

『項目記入』命令(vnako専用)を使うと多くの項目を一度に入力することができます。
例えば、FTPのホスト名、パスワードなどを一度に入力するプログラムが
以下になります。

♪ソース〜＠＠
「HOST=ftp.xxx.xx
ID=
PASSWORD=
PORT=21」と項目記入して、FTP設定に代入。
もし、FTP設定が空ならば、おわる。
FTP設定@「HOST」を表示
FTP設定@「ID」を表示
＠＠

『項目記入』の引数には、「キー=値」の形式で値を指定します。
すると、返り値にハッシュ形式で値を返します。
ハッシュ形式なので『変数名＠キー』の形で返り値から任意のキーを
取り出すことができます。

また、項目記入ではオプションを指定することにより、より詳しい
入力規則を設定できます。

,オプション,意味,利用例
,?(選択肢1|選択肢2|選択肢3),コンボから選択肢を選択できる,?(エビ|ウニ|イクラ)エビ 
,?f または ?f(拡張子リスト),ファイル選択ダイアログでファイルを選択できる,?f(テキストファイル|*.txt) 
,?d(初期フォルダ),フォルダ選択ダイアログでフォルダを選択できる,?d(c:\)
,?c ,色選択ダイアログで色番号を選択できる。,?c 
,?s ,IMEをオンにする,?s 
,?e ,IMEをオフにする,?e 


●数値入力

『数値入力』命令を使うと、数値入力ダイアログを表示します。

♪ソース〜→→→
「数値を入力してください」の数値入力して表示。
→→→

■ダイアログオプション

ダイアログの命令は手軽に使えるのが魅力ですが、
IMEの状態を制御したいとか初期値を設定しておきたい場合など、
もうちょっと細かい設定をしたい場合があります。
その場合、以下の変数に値を設定しておきます。

,変数名,役割
,ダイアログ初期値,ダイアログの初期値を設定したい場合
,ダイアログキャンセル値,キャンセルボタンを押したときに返される値
,ダイアログIME,IMEの状態を制御したい場合
,ダイアログ数値変換,『尋ねる』の入力結果を必ず文字列にしたい場合はオフを指定する

このうち『ダイアログIME』に設定する値は、
IMEオン｜IMEオフ｜IMEかな｜IMEカナ｜IME半角
のいづれかを指定します。

♪ソース〜＠＠
ダイアログ初期値は「太郎」
ダイアログキャンセル値は「名無し」
ダイアログIMEは「IMEカタカナ」
「名前は？」と尋ねる
それを言う
＠＠



