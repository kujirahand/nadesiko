★音楽の再生

♪概要
　なでしこで手軽に音楽再生できます。

■再生方法

『再生』命令を使うと、さまざまな音楽ファイルを再生できます。
内部的にはMCIを利用しているので、メディアプレイヤーで
再生できるファイルの種類なら再生できます。

Windows Media Player 9.00がインストールされいている場合は、
MIDI, WMA, WAV, AU, AIFF, MP3, AVI, MPEGなどを演奏できるようです。

♪ソース〜＠＠
「xxx.mid」を再生
＠＠

『停止』命令で演奏を停止できます。

●音で知らせる

ピッと音を鳴らすだけならば、「BEEP」と書くと音が鳴らせます。

■ＭＣＩ

ＭＣＩ命令を使うと、もう少し細かく演奏を制御できます。
『ＭＣＩ開く』でファイルを開きます。
そのとき、開いたファイルをなんという識別子を使って制御するかを
指定します。（これは半角英数で指定します。）

その後、『ＭＣＩ再生』や『ＭＣＩ停止』などの命令を識別子を使って
制御できます。

♪ソース〜＠＠
「音楽ファイル.mp3」を「music」でMCI開く
「music」をMCI再生
「停止」と言う
「music」をMCI閉じる
＠＠

また、『ＭＣＩ開く』では識別子を指定してファイルを開くことが
できますので、複数のファイルを開いておいて、任意のタイミングで
再生するということが可能になります。

♪ソース〜＠＠
「MCIを開きます」と言う
「xxxx.mid」を「p1」でMCI開く
「xxxx.mid」を「p2」でMCI開く
「xxxx.mid」を「p3」でMCI開く
「再生します」と言う
「p2」をMCI再生
「停止します」と言う
「p2」をMCI停止
「MCIを閉じます」と言う
「p1」をMCI閉じる
「p2」をMCI閉じる
「p3」をMCI閉じる
＠＠

●ＭＣＩ送信

ＭＣＩ送信命令を使うと、さらに細かい指定が可能になります。
例えば以下は、繰り返し再生を行う例です。
（ただし、再生する音楽の種類によってはサポートしないこともあります。）

♪ソース〜＠＠
「音楽ファイル.mp3」を「music」でMCI開く
「play music repeat」をMCI送信
「停止」と言う
「music」をMCI閉じる
＠＠

そのほかのＭＣＩコマンドの例です。
他にもありますが、代表的なものをのせておきます。

,コマンド, 説明
,play NAME repeat, 音楽をループ演奏する
,pause NAME, 音楽を一時停止する
,seek NAME to POS, 演奏位置をPOSに変更する
,status NAME length, 演奏の長さを求める
,status NAME position, 曲の演奏位置を求める

