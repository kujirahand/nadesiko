★レジストリ

♪概要
Windowsのレジストリの読み書きができます。
レジストリの操作を誤ると大変なことになるので慎重に行います。

■レジストリの読み書き手順

Windows95以降ではドライブにCDやDVDを入れると
自動的に起動するオートラン機能が実装されています。
これの設定を読み込む例です。

♪ソース〜＠＠
KEY=『HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Cdrom』
KEYのレジストリ開いてHに代入。
Hで「AutoRun」をレジストリ整数読む
もし、それがオンならば
　　「自動起動がオンです」と表示
違えば
　　「自動起動はオフです」と表示。
Hのレジストリ閉じる
＠＠

いきなりではよくわからないと思いますので
レジストリ操作の基本をみてみましょう。

・（１）『レジストリ開く』命令でキーを開いて、操作ハンドルを得る
・（２）ハンドルを使ってデータを読み書きする
・（３）『レジストリ閉じる』命令で操作ハンドルを閉じる

と、この手順に従って操作します。

では、今度はオートランをオフにする例です。

♪ソース〜＠＠
# オートランをオフにします
KEY=『HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Cdrom』
KEYのレジストリ開いてHに代入
Hで「AutoRun」に0をレジストリ整数書く
Hのレジストリ閉じる
＠＠

■利用例〜壁紙

次に壁紙の設定を読んでみます。

♪ソース〜＠＠
KEY=『HKEY_CURRENT_USER\Control Panel\Desktop』
KEYのレジストリ開いてHに代入
Hで「Wallpaper」をレジストリ読む
それを表示。
Hのレジストリ閉じる
＠＠

上のプログラムは壁紙が設定されていれば、壁紙の
ファイル名を取得して表示するという例です。

今回はレジストリの読み取りに『レジストリ読む』を使っています。
レジストリには、文字列型や、整数型など型があります。

整数型の場合は『レジストリ整数読む』『レジストリ整数書く』を
使って読み書きします。

今回のように文字列型の場合は『レジストリ書く』『レジストリ読む』を
使います。



